<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>使用 Skia 绘制 2D 图形 | 正经博客</title>
    <meta name="generator" content="VuePress 1.9.10">
    <link rel="icon" href="/favicon.ico">
    <meta name="description" content="陈俊生的正经博客">
    
    <link rel="preload" href="/assets/css/0.styles.985c0261.css" as="style"><link rel="preload" href="/assets/js/app.efdf1017.js" as="script"><link rel="preload" href="/assets/js/2.d444b0a2.js" as="script"><link rel="preload" href="/assets/js/1.7ca1e89d.js" as="script"><link rel="preload" href="/assets/js/61.24ba53e0.js" as="script"><link rel="prefetch" href="/assets/js/10.1a004c10.js"><link rel="prefetch" href="/assets/js/11.6560bed7.js"><link rel="prefetch" href="/assets/js/12.20398b1f.js"><link rel="prefetch" href="/assets/js/13.6f95ee0c.js"><link rel="prefetch" href="/assets/js/14.782f19f1.js"><link rel="prefetch" href="/assets/js/15.d25bd3fe.js"><link rel="prefetch" href="/assets/js/16.97c2c4a8.js"><link rel="prefetch" href="/assets/js/17.895b550f.js"><link rel="prefetch" href="/assets/js/18.cdc68d17.js"><link rel="prefetch" href="/assets/js/19.ef8e3a48.js"><link rel="prefetch" href="/assets/js/20.b5d8c482.js"><link rel="prefetch" href="/assets/js/21.2980ee98.js"><link rel="prefetch" href="/assets/js/22.b16736cf.js"><link rel="prefetch" href="/assets/js/23.221060a2.js"><link rel="prefetch" href="/assets/js/24.bb5e2239.js"><link rel="prefetch" href="/assets/js/25.65cbc6a7.js"><link rel="prefetch" href="/assets/js/26.ee90196a.js"><link rel="prefetch" href="/assets/js/27.101bf521.js"><link rel="prefetch" href="/assets/js/28.35ac7c38.js"><link rel="prefetch" href="/assets/js/29.aacd3977.js"><link rel="prefetch" href="/assets/js/3.5ff63961.js"><link rel="prefetch" href="/assets/js/30.68a43ff9.js"><link rel="prefetch" href="/assets/js/31.cc9a91ad.js"><link rel="prefetch" href="/assets/js/32.12ebb196.js"><link rel="prefetch" href="/assets/js/33.a4383cda.js"><link rel="prefetch" href="/assets/js/34.bfa72010.js"><link rel="prefetch" href="/assets/js/35.aeb2002f.js"><link rel="prefetch" href="/assets/js/36.0a918e07.js"><link rel="prefetch" href="/assets/js/37.e00295cb.js"><link rel="prefetch" href="/assets/js/38.da376bbb.js"><link rel="prefetch" href="/assets/js/39.2f9ba8d7.js"><link rel="prefetch" href="/assets/js/4.86934754.js"><link rel="prefetch" href="/assets/js/40.86d171b4.js"><link rel="prefetch" href="/assets/js/41.f1a79136.js"><link rel="prefetch" href="/assets/js/42.f7b4a720.js"><link rel="prefetch" href="/assets/js/43.b824f47f.js"><link rel="prefetch" href="/assets/js/44.b54f4a3e.js"><link rel="prefetch" href="/assets/js/45.2aae7666.js"><link rel="prefetch" href="/assets/js/46.185897cf.js"><link rel="prefetch" href="/assets/js/47.b5418ff9.js"><link rel="prefetch" href="/assets/js/48.099d6193.js"><link rel="prefetch" href="/assets/js/49.18417fbf.js"><link rel="prefetch" href="/assets/js/5.ed646e61.js"><link rel="prefetch" href="/assets/js/50.852f955c.js"><link rel="prefetch" href="/assets/js/51.b571fc7f.js"><link rel="prefetch" href="/assets/js/52.05037053.js"><link rel="prefetch" href="/assets/js/53.69bf0a82.js"><link rel="prefetch" href="/assets/js/54.9449705b.js"><link rel="prefetch" href="/assets/js/55.899be268.js"><link rel="prefetch" href="/assets/js/56.b40737e3.js"><link rel="prefetch" href="/assets/js/57.4e74d18a.js"><link rel="prefetch" href="/assets/js/58.4ba1d249.js"><link rel="prefetch" href="/assets/js/59.9a911d76.js"><link rel="prefetch" href="/assets/js/6.b1c318f0.js"><link rel="prefetch" href="/assets/js/60.cc0e0926.js"><link rel="prefetch" href="/assets/js/62.6ff74996.js"><link rel="prefetch" href="/assets/js/63.d31d2aac.js"><link rel="prefetch" href="/assets/js/64.d14c4015.js"><link rel="prefetch" href="/assets/js/65.124611bc.js"><link rel="prefetch" href="/assets/js/66.da3bf42d.js"><link rel="prefetch" href="/assets/js/67.e17449ef.js"><link rel="prefetch" href="/assets/js/68.ce06c506.js"><link rel="prefetch" href="/assets/js/69.dbda80ad.js"><link rel="prefetch" href="/assets/js/7.f368e4d8.js"><link rel="prefetch" href="/assets/js/70.33b15820.js"><link rel="prefetch" href="/assets/js/71.c74741b4.js"><link rel="prefetch" href="/assets/js/72.b5e33ea4.js"><link rel="prefetch" href="/assets/js/73.5d09bd2e.js"><link rel="prefetch" href="/assets/js/vendors~docsearch.12181bb4.js">
    <link rel="stylesheet" href="/assets/css/0.styles.985c0261.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">正经博客</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/aboutme.html" class="nav-link">
  About Me
</a></div> <a href="https://github.com/hentaicracker/new-blog/tree/vuepress" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/aboutme.html" class="nav-link">
  About Me
</a></div> <a href="https://github.com/hentaicracker/new-blog/tree/vuepress" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>2025</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/2025/zongjie.html" class="sidebar-link">2024 &amp; 2025</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>2024</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/2024/jietu.html" class="sidebar-link">长截图生成实践</a></li><li><a href="/2024/zongjie.html" class="sidebar-link">2023 &amp; 2024</a></li><li><a href="/2024/chengzhang.html" class="sidebar-link">工程师的自我修养</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>2023</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/2023/suibi.html" class="sidebar-link">路遥远，我们一起走</a></li><li><a href="/2023/rust-1.html" class="sidebar-link">《Rust 程序设计语言》读书笔记</a></li><li><a href="/2023/docker.html" class="sidebar-link">使用 Docker 搭建开发环境</a></li><li><a href="/2023/zongjie.html" class="sidebar-link">Do not be afraid</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>2022</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/2022/skia.html" aria-current="page" class="active sidebar-link">使用 Skia 绘制 2D 图形</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/2022/skia.html#_1-skia" class="sidebar-link">1.Skia</a></li><li class="sidebar-sub-header"><a href="/2022/skia.html#_2-图形变换" class="sidebar-link">2. 图形变换</a></li><li class="sidebar-sub-header"><a href="/2022/skia.html#_3-绘制举例" class="sidebar-link">3 绘制举例</a></li><li class="sidebar-sub-header"><a href="/2022/skia.html#参考资料" class="sidebar-link">参考资料</a></li></ul></li><li><a href="/2022/mf.html" class="sidebar-link">基于 MF 的组件化共享工作流 - Qcon 广州演讲整理</a></li><li><a href="/2022/zongjie.html" class="sidebar-link">2021 年终总结</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>2021</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/2021/docker-osx.html" class="sidebar-link">使用 docker-osx 搭建 macos 构建环境</a></li><li><a href="/2021/zongjie.html" class="sidebar-link">工作 5 年</a></li><li><a href="/2021/deco.html" class="sidebar-link">解构 Deco 编辑器</a></li><li><a href="/2021/py.html" class="sidebar-link">面向前端工程师的 Python 快速入门（30min）</a></li><li><a href="/2021/ts.html" class="sidebar-link">TypeScript 类型编程</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>2020</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/2020/deco.html" class="sidebar-link">Deco 图层处理层简明介绍</a></li><li><a href="/2020/rAF.html" class="sidebar-link">requestAnimationFrame 执行机制探索</a></li><li><a href="/2020/aopioc.html" class="sidebar-link">Nodejs AOP 与 IOC 实践</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>2019</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/2019/hooks.html" class="sidebar-link">使用 React Hooks + Context 打造简版 Redux</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>2018</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/2018/lazyload.html" class="sidebar-link">图片懒加载踩坑</a></li><li><a href="/2018/protocol.html" class="sidebar-link">互联网协议梳理</a></li><li><a href="/2018/authenticate.html" class="sidebar-link">用户认证流程梳理</a></li><li><a href="/2018/http.html" class="sidebar-link">HTTP 详细</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>2017</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/2017/2017-08-06.html" class="sidebar-link">《硅谷钢铁侠——马斯克的冒险人生》读书笔记</a></li><li><a href="/2017/jsTips.html" class="sidebar-link">JavaScript Tips</a></li><li><a href="/2017/regexp.html" class="sidebar-link">正则表达式 cheatsheet &amp; 实例</a></li><li><a href="/2017/string.html" class="sidebar-link">String 踩坑</a></li><li><a href="/2017/ydkjs-1.html" class="sidebar-link">《You don't know JavaScirpt》</a></li><li><a href="/2017/2017-03-12.html" class="sidebar-link">《人类简史》读书笔记</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>2016</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/2016/2016-12-31.html" class="sidebar-link">2016 &amp; 2017</a></li><li><a href="/2016/2016-11-16.html" class="sidebar-link">《围城》读书笔记</a></li><li><a href="/2016/2016-10-29.html" class="sidebar-link">《血色浪漫》读书笔记</a></li><li><a href="/2016/2016-09-21.html" class="sidebar-link">这段时间的感受与见闻</a></li><li><a href="/2016/hello-world.html" class="sidebar-link">《乔布斯传》读书笔记</a></li><li><a href="/2016/liqi.html" class="sidebar-link">我是荒野大镖客，这是我的利器</a></li><li><a href="/2016/2016-04-23.html" class="sidebar-link">学习日常</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><p>在羚珑智能设计工具——程序化设计里，我们需要根据设计师给到的作图规范来绘制对应的图形，通过输入不同的参数输出不同的设计结果，上面背景图就是程序化设计里一个2.5D背景模型生成图片的一些例子。那我们使用的绘图工具就是 skia。</p> <p><img src="https://img20.360buyimg.com/ling/jfs/t1/126306/11/29547/236852/63c0fc84F911ce7eb/9b5e558c6e3d9531.jpg" alt="tu1"></p> <h2 id="_1-skia"><a href="#_1-skia" class="header-anchor">#</a> 1.Skia</h2> <h3 id="_1-1-skia-简单介绍"><a href="#_1-1-skia-简单介绍" class="header-anchor">#</a> 1.1 Skia 简单介绍</h3> <p>Skia 是一个开源 2D 图形库，它提供适用于各种硬件和软件平台的通用 API。 它作为 Google Chrome 和 ChromeOS、Android、Flutter 和许多其他产品的图形引擎。Skia 支持多语言调用， C++/C#/Java/Python/Rust/WASM 等。</p> <p>程序化设计有浏览器端以及服务端的绘制需求，所以我们选择 <a href="https://www.npmjs.com/package/canvaskit-wasm" target="_blank" rel="noopener noreferrer">canvaskit-wasm<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 这个 Skia 打包出来的供 JS 调用的 WebAssembly NPM 包，在 web 端以及 nodejs 端都能使用，这样就满足了多端的需求。</p> <h3 id="_1-2-常用绘图-api"><a href="#_1-2-常用绘图-api" class="header-anchor">#</a> 1.2 常用绘图 API</h3> <p><strong>Surface</strong></p> <p>Surface 是一个对象，用于管理绘制画布命令的内存，通过处理这段内存信息，可以将它转成图片。</p> <p>下面的代码显示如何加载这个包并进行 API 调用：</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">import</span> CanvasKitInit <span class="token keyword">from</span> <span class="token string">'canvaskit-wasm'</span>

<span class="token keyword">const</span> loadLib <span class="token operator">=</span> <span class="token function">CanvasKitInit</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token function">locateFile</span><span class="token punctuation">(</span>file<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token string">'https://unpkg.com/canvaskit-wasm@0.19.0/bin/'</span> <span class="token operator">+</span> file
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

loadLib<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>lib <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// 创建 500x500 的 surface</span>
  <span class="token keyword">const</span> surface <span class="token operator">=</span> lib<span class="token punctuation">.</span><span class="token function">MakeSurface</span><span class="token punctuation">(</span><span class="token number">500</span><span class="token punctuation">,</span> <span class="token number">500</span><span class="token punctuation">)</span>
  <span class="token comment">// 获取画布</span>
  <span class="token keyword">const</span> canvas <span class="token operator">=</span> surface<span class="token punctuation">.</span><span class="token function">getCanvas</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p><strong>Canvas</strong></p> <p>Canvas 是 Skia 绘图上下文，它提供了绘图的接口。</p> <ul><li>canvas.drawRect()：绘制一个矩形</li> <li>canvas.drawCircle()：绘制一个圆</li> <li>canvas.drawLine()：绘制一条直线</li> <li>canvas.drawPath()：绘制一条路径</li> <li>canvas.drawArc()：绘制一条圆弧</li> <li>canvas.drawText()：绘制文字</li> <li>...</li></ul> <p><strong>Path</strong></p> <p>Path 绘制路径。</p> <ul><li>path.moveTo(x, y)：从(x,y)开始绘制一个路径</li> <li>path.lineTo()：将直线添加到路径</li> <li>path.arcTo()：将弧线添加到路径</li> <li>path.cubicTo()：添加贝塞尔曲线</li> <li>path.quadTo()：添加二次贝齐尔曲线</li> <li>path.close()：闭合路径</li> <li>path.addRect()：添加一个矩形到路径</li> <li>path.addCircle()：添加圆</li> <li>path.addOval()：添加椭圆</li> <li>path.addRoundedRect()：添加圆角矩形</li> <li>path.addArc()：添加圆弧</li> <li>path.addPath()：添加另一个路径</li> <li>...</li></ul> <p>Path 绘制例1：</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token comment">// 绘制三角形</span>
<span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">CanvasKit</span><span class="token punctuation">.</span><span class="token function">Path</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
path<span class="token punctuation">.</span><span class="token function">moveTo</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span>
path<span class="token punctuation">.</span><span class="token function">lineTo</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span>
path<span class="token punctuation">.</span><span class="token function">lineTo</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span>
path<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">// 绘制贝塞尔曲线</span>
<span class="token keyword">const</span> arcPath <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">CanvasKit</span><span class="token punctuation">.</span><span class="token function">Path</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
arcPath<span class="token punctuation">.</span><span class="token function">moveTo</span><span class="token punctuation">(</span><span class="token number">55</span><span class="token punctuation">,</span> <span class="token number">55</span><span class="token punctuation">)</span>
arcPath<span class="token punctuation">.</span><span class="token function">cubicTo</span><span class="token punctuation">(</span><span class="token number">120</span><span class="token punctuation">,</span> <span class="token number">150</span><span class="token punctuation">,</span> <span class="token number">130</span><span class="token punctuation">,</span> <span class="token number">180</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">)</span>

<span class="token comment">// 添加曲线路径</span>
path<span class="token punctuation">.</span><span class="token function">addPath</span><span class="token punctuation">(</span>arcPath<span class="token punctuation">)</span>

canvas<span class="token punctuation">.</span><span class="token function">drawPath</span><span class="token punctuation">(</span>path<span class="token punctuation">,</span> paint<span class="token punctuation">)</span> <span class="token comment">// paint 画笔，见下文</span>
</code></pre></div><p>绘制结果：</p> <p><img src="https://img20.360buyimg.com/ling/s516x0_jfs/t1/146464/31/32093/88539/63c108bfF7a8ef1f7/adcc517b4bf0b5e5.png" alt="exp1"></p> <p><strong>Paint</strong></p> <p>Paint 画笔，用于存储当前绘制图形的样式信息。</p> <ul><li>paint.setColor()：设置画笔颜色</li> <li>paint.setAlphaf()：设置透明度</li> <li>paint.setAntiAlias()：抗锯齿</li> <li>paint.setBlendMode()：设置混合模式</li> <li>paint.setStyle()：设置画笔样式</li> <li>paint.setStrokeWidth()：设置描边宽度</li> <li>paint.setColorFilter()：设置颜色筛选器</li> <li>paint.setImageFilter()：设置图像筛选器</li> <li>paint.setMaskFilter()：设置掩码筛选器</li> <li>paint.setShader()：设置着色器</li> <li>...</li></ul> <p>例1 中需要加上 Paint 进行样式绘制：</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">const</span> <span class="token punctuation">{</span> Path<span class="token punctuation">,</span> parseColorString <span class="token punctuation">}</span> <span class="token operator">=</span> CanvasKit

<span class="token keyword">const</span> paint <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Paint</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
paint<span class="token punctuation">.</span><span class="token function">setStyle</span><span class="token punctuation">(</span>PaintStyle<span class="token punctuation">.</span>Stroke<span class="token punctuation">)</span>
paint<span class="token punctuation">.</span><span class="token function">setColor</span><span class="token punctuation">(</span><span class="token function">parseColorString</span><span class="token punctuation">(</span><span class="token string">'#000000'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

canvas<span class="token punctuation">.</span><span class="token function">drawPath</span><span class="token punctuation">(</span>path<span class="token punctuation">,</span> paint<span class="token punctuation">)</span>
</code></pre></div><p><strong>Shader</strong></p> <p>Shader 着色器，用于绘制渐变、噪声、平铺等效果。</p> <ul><li>shader.MakeColor()：设置着色器颜色</li> <li>shader.MakeLinearGradient()：线性渐变</li> <li>shader.MakeRadialGradient()：径向渐变</li> <li>shader.MakeSweepGradient()：扫描渐变</li> <li>shader.MakeTwoPointConicalGradient()：两点圆锥渐变</li> <li>shader.MakeFractalNoise()：柏林噪声</li> <li>shader.MakeTurbulence()：平铺柏林噪声</li> <li>shader.MakeBlend()：组合多个着色器效果</li></ul> <p>Shader 绘制例2：</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">const</span> <span class="token punctuation">{</span> Shader<span class="token punctuation">,</span> parseColorString<span class="token punctuation">,</span> TileMode <span class="token punctuation">}</span> <span class="token operator">=</span> CanvasKit

<span class="token keyword">const</span> shader <span class="token operator">=</span> Shader<span class="token punctuation">.</span><span class="token function">MakeLinearGradient</span><span class="token punctuation">(</span>
  <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment">// 渐变开始点</span>
  <span class="token punctuation">[</span><span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment">// 渐变结束点</span>
  <span class="token punctuation">[</span>
    <span class="token function">parseColorString</span><span class="token punctuation">(</span><span class="token string">'#ff0000'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token function">parseColorString</span><span class="token punctuation">(</span><span class="token string">'#ffff00'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token function">parseColorString</span><span class="token punctuation">(</span><span class="token string">'#0000ff'</span><span class="token punctuation">)</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment">// 渐变颜色</span>
  <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0.5</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment">// 颜色范围比例</span>
  TileMode<span class="token punctuation">.</span>Clamp<span class="token punctuation">,</span> <span class="token comment">// 范围外颜色样式模式</span>
<span class="token punctuation">)</span>

paint<span class="token punctuation">.</span><span class="token function">setShader</span><span class="token punctuation">(</span>shader<span class="token punctuation">)</span>
</code></pre></div><p>绘制结果：</p> <p><img src="https://img11.360buyimg.com/ling/s516x0_jfs/t1/77056/39/18402/174168/63c10cf1F7c8ed4a9/ace841783b14eb7f.png" alt="jianbian"></p> <p><strong>Blendmode</strong></p> <p>Blendmode 混合模式，用于确定当两个图形对象互相重叠时需要如何绘制。主要分为三大类：</p> <table><thead><tr><th>Porter-Duff</th> <th>分离</th> <th>不可分离</th></tr></thead> <tbody><tr><td>Clear</td> <td>Modulate</td> <td>Hue</td></tr> <tr><td>Src</td> <td>Overlay</td> <td>Saturation</td></tr> <tr><td>Dst</td> <td>Darken</td> <td>Color</td></tr> <tr><td>SrcOver</td> <td>Lighten</td> <td>Luminosity</td></tr> <tr><td>DstOver</td> <td>ColorDodge</td> <td>-</td></tr> <tr><td>SrcIn</td> <td>ColorBurn</td> <td>-</td></tr> <tr><td>DstIn</td> <td>HardLight</td> <td>-</td></tr> <tr><td>SrcOut</td> <td>SoftLight</td> <td>-</td></tr> <tr><td>DstOut</td> <td>Difference</td> <td>-</td></tr> <tr><td>SrcATop</td> <td>Exclusion</td> <td>-</td></tr> <tr><td>DstATop</td> <td>Multiply</td> <td>-</td></tr> <tr><td>Xor</td> <td>-</td> <td>-</td></tr> <tr><td>Plus</td> <td>-</td> <td>-</td></tr></tbody></table> <ol><li><p>Porter-Duff 模式：通常用于执行裁剪操作</p> <p><img src="https://img14.360buyimg.com/ling/s516x0_jfs/t1/15464/37/20481/359877/63c10ff4Fd7b2a00c/d25b6d930eaefa4a.png" alt="Porter-Duff"></p></li> <li><p>可分离混合模式：可以混合颜色，通常用于照亮或变暗图像。</p> <p><img src="https://img12.360buyimg.com/ling/s516x0_jfs/t1/212414/27/25126/389828/63c11004Fcc2d4a93/19600269744705bc.png" alt="fenli"></p></li> <li><p>不可分离混合模式：可以混合颜色，通常通过对色调、饱和度和亮度颜色级别进行操作。</p> <p><img src="https://img14.360buyimg.com/ling/s516x0_jfs/t1/81469/23/23788/174728/63c1100aF6073809c/5dced93dc8da4ba2.png" alt="bukefenli"></p></li></ol> <p><strong>Matrix</strong></p> <p>Matrix 矩阵工具，用于图形变换、数学计算等，主要有三个：</p> <ol><li>ColorMatrix: 用于计算颜色</li> <li>Matrix: 3x3矩阵计算，常用于二维图形变换</li> <li>M44: 4x4矩阵计算，三维图形变换</li></ol> <p>矩阵是图形变换不可或缺的计算工具，接下来详细阐述一下关于二维图形变换的工具——Matrix。</p> <h2 id="_2-图形变换"><a href="#_2-图形变换" class="header-anchor">#</a> 2. 图形变换</h2> <p>所有的图形变换本质上是点的坐标变换，即：</p> <div class="language- extra-class"><pre class="language-text"><code>(x, y) =&gt; (x', y')
</code></pre></div><p>要实现点的坐标变换，需要借助一个中间矩阵与坐标点相乘之后得到变换结果：</p> <div class="language- extra-class"><pre class="language-text"><code>(x, y) × 中间矩阵 = (x', y')
</code></pre></div><p>在 Skia 中需要借助一个 3x3 的矩阵进行坐标变换（原因见下文）：</p> <div class="language- extra-class"><pre class="language-text"><code>                │ ScaleX  SkewY   Persp0 │
| x  y  1 |  ×  │ SkewX   ScaleY  Persp1 │ = | x'  y'  z' |
                │ TransX  TransY  Persp2 │
</code></pre></div><p>这里可以理解为在三维的某个面上进行图形变换，为了方便计算，我们将 z 值设为 1，相当于在 z 值为 1 的平面上进行变换：</p> <div class="language- extra-class"><pre class="language-text"><code>z' = 1
xFinal = x' / z' = x'
yFinal = y' / z' = y'
</code></pre></div><p>最后就得到了最终变换的结果：</p> <div class="language- extra-class"><pre class="language-text"><code>(x, y) =&gt; (xFinal, yFinal)
</code></pre></div><p>Skia 中也提供了一个方便的方法实现坐标变换：</p> <div class="language-ts extra-class"><pre class="language-ts"><code>Matrix<span class="token punctuation">.</span><span class="token function">mapPoints</span><span class="token punctuation">(</span>mat<span class="token punctuation">,</span> <span class="token punctuation">[</span>x<span class="token punctuation">,</span> y<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment">// 得到经 mat 矩阵变换之后的 x/y 坐标</span>
</code></pre></div><blockquote><p>Skia 中的坐标系与经典直角坐标系（笛卡尔坐标系）有所区别，它的 y 轴正方向是向下的，所以变换矩阵也有一些区别。</p></blockquote> <p>接下来详细介绍一下常见的图形变换。</p> <h3 id="_2-1-平移变换"><a href="#_2-1-平移变换" class="header-anchor">#</a> 2.1 平移变换</h3> <p>平移变换在水平方向和垂直方向移动图形对象，如下图宽高为 1 的矩形（单位矩形）由 (0,0) 点向 x 轴移动到 X，向 y 轴移动到 Y：</p> <p><img src="https://img30.360buyimg.com/ling/s516x0_jfs/t1/174798/8/33326/74788/63c11daeF5a72fb92/aa6e109b3491399a.png" alt="pingyi"></p> <p>平移变换的中间矩阵：</p> <div class="language- extra-class"><pre class="language-text"><code>                │ 1  0  0 │
| x  y  1 |  ×  │ 0  1  0 │ = | x'  y'  1 |
                │ X  Y  1 │
</code></pre></div><blockquote><p>这里可以解释一下为何需要使用 3x3 矩阵去做变换，是因为二维矩阵无法表达 平移 这种最基础的图形变换，2x2 矩阵表示两个维度中的线性变换，线性变换无法改变 (0,0)，所以需要借助升维来解决。见<a href="https://learn.microsoft.com/en-us/xamarin/xamarin-forms/user-interface/graphics/skiasharp/transforms/matrix#the-reason-for-the-3-by-3-matrix" target="_blank" rel="noopener noreferrer">参考资料<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>。</p></blockquote> <p>在 Skia 中可以使用 <code>Matrix.translated()</code> 方法来方便做平移变换：</p> <div class="language-ts extra-class"><pre class="language-ts"><code>Matrix<span class="token punctuation">.</span><span class="token function">translated</span><span class="token punctuation">(</span><span class="token constant">X</span><span class="token punctuation">,</span> <span class="token constant">Y</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="_2-2-缩放变换"><a href="#_2-2-缩放变换" class="header-anchor">#</a> 2.2 缩放变换</h3> <p>缩放变换会更改图形对象的大小，如下图矩形在 x 方向上缩放了 W 倍，在 y 方向上缩放了 H 倍：</p> <p><img src="https://img12.360buyimg.com/ling/s516x0_jfs/t1/58987/18/23148/79966/63c11daeF74e6b196/05547453a923bc99.png" alt="bukefenli"></p> <p>缩放变换的中间矩阵：</p> <div class="language- extra-class"><pre class="language-text"><code>                │ W  0  0 │
| x  y  1 |  ×  │ 0  H  0 │ = | x'  y'  1 |
                │ 0  0  1 │
</code></pre></div><p>在 Skia 中可以使用 <code>Matrix.scaled()</code> 方法来方便做缩放变换：</p> <div class="language-ts extra-class"><pre class="language-ts"><code>Matrix<span class="token punctuation">.</span><span class="token function">scaled</span><span class="token punctuation">(</span><span class="token constant">W</span><span class="token punctuation">,</span> <span class="token constant">H</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="_2-3-旋转变换"><a href="#_2-3-旋转变换" class="header-anchor">#</a> 2.3 旋转变换</h3> <p>旋转变换使图形围绕某个点进行旋转，如下图矩形围绕着 (0,0) 旋转了 θ 度：</p> <p><img src="https://img14.360buyimg.com/ling/s516x0_jfs/t1/50243/27/18084/102974/63c11daeF4587b0ac/1d2839bffc478466.png" alt="bukefenli"></p> <p>旋转变换的中间矩阵：</p> <div class="language- extra-class"><pre class="language-text"><code>                │  cos(θ)  sin(θ)  0 │
| x  y  1 |  ×  │ -sin(θ)  cos(θ)  0 │ = | x'  y'  1 |
                │    0       0     1 │
</code></pre></div><p>在 Skia 中可以使用 <code>Matrix.rotated()</code> 方法来方便做旋转变换：</p> <div class="language-ts extra-class"><pre class="language-ts"><code>Matrix<span class="token punctuation">.</span><span class="token function">rotated</span><span class="token punctuation">(</span><span class="token function">toRadians</span><span class="token punctuation">(</span>θ<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token comment">// 需要将角度转换为弧度</span>
</code></pre></div><h3 id="_2-4-倾斜变换"><a href="#_2-4-倾斜变换" class="header-anchor">#</a> 2.4 倾斜变换</h3> <p>倾斜变换可以使图形在水平或垂直方向上倾斜。</p> <p>如下图在垂直方向上倾斜了 α 度：</p> <p><img src="https://img20.360buyimg.com/ling/s516x0_jfs/t1/150186/17/33196/67526/63c11daeF558f9335/b49e447d5290ba58.png" alt="bukefenli"></p> <p>下图在水平方向上倾斜了 θ 度：</p> <p><img src="https://img14.360buyimg.com/ling/s516x0_jfs/t1/217337/7/22320/64047/63c11daeF3802ba58/4cd3026b01709c80.png" alt="bukefenli"></p> <p>倾斜变换的中间矩阵：</p> <div class="language- extra-class"><pre class="language-text"><code>                │    1     tan(α)  0 │
| x  y  1 |  ×  │  tan(θ)    1     0 │ = | x'  y'  1 |
                │    0       0     1 │
</code></pre></div><p>在 Skia 中可以使用 <code>Matrix.skewed()</code> 方法来方便做倾斜变换：</p> <div class="language-ts extra-class"><pre class="language-ts"><code>Matrix<span class="token punctuation">.</span><span class="token function">skewed</span><span class="token punctuation">(</span><span class="token function">tan</span><span class="token punctuation">(</span>α<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">tan</span><span class="token punctuation">(</span>θ<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="_2-5-透视变换"><a href="#_2-5-透视变换" class="header-anchor">#</a> 2.5 透视变换</h3> <p>透视变换可以实现图形的透视效果，它可以使矩形变换成任意凸四边形，下图将底边在水平方向分别扩展了 X1、X2 的距离：</p> <p><img src="https://img13.360buyimg.com/ling/s516x0_jfs/t1/182082/19/31560/85728/63c11daeF6a05545e/576186b26cf47044.png" alt="bukefenli"></p> <p>由此，我们可以知道变换前以及变换后每个顶点的坐标，通过这些坐标值，可以计算透视中间矩阵。</p> <p>首先，通过 Skia 的中间矩阵变换计算可以得到以下公式：</p> <div class="language- extra-class"><pre class="language-text"><code>x' = ScaleX·x + SkewX·y + TransX
y' = SkewY·x + ScaleY·y + TransY
z' = Persp0·x + Persp1·y + Persp2

xFinal = x' / z'
yFinal = y' / z'
z' = 1
</code></pre></div><p>于是可以得到 xFinal, yFinal:</p> <div class="language- extra-class"><pre class="language-text"><code>xFinal = (ScaleX·x + SkewX·y + TransX) / (Persp0·x + Persp1·y + Persp2)
yFinal = (SkewY·x + ScaleY·y + TransY) / (Persp0·x + Persp1·y + Persp2)
</code></pre></div><p>将变换前的 (0, 0)、(w, 0)、(0, h)、(w, h) 以及变换后的 (x1, y1)、(x2, y2)、(x3, y3)、(x4, y4) 代入公式：</p> <div class="language- extra-class"><pre class="language-text"><code>x1 = (ScaleX·0 + SkewX·0 + TransX) / (Persp0·0 + Persp1·0 + Persp2)
y1 = (SkewY·0 + ScaleY·0 + TransY) / (Persp0·0 + Persp1·0 + Persp2)

x2 = (ScaleX·w + SkewX·0 + TransX) / (Persp0·w + Persp1·0 + Persp2)
y2 = (SkewY·w + ScaleY·0 + TransY) / (Persp0·w + Persp1·0 + Persp2)

x3 = (ScaleX·w + SkewX·h + TransX) / (Persp0·w + Persp1·h + Persp2)
y3 = (SkewY·w + ScaleY·h + TransY) / (Persp0·w + Persp1·h + Persp2)

x4 = (ScaleX·0 + SkewX·h + TransX) / (Persp0·0 + Persp1·h + Persp2)
y4 = (SkewY·0 + ScaleY·h + TransY) / (Persp0·0 + Persp1·h + Persp2)
</code></pre></div><p>简化之后：</p> <div class="language- extra-class"><pre class="language-text"><code>x1·Persp2 - TransX = 0
y1·Persp2 - TransY = 0

Persp0·w·x2 + Persp2·x2 - ScaleX·w - TransX = 0
Persp0·w·y2 + Persp2·y2 - SkewY·w - TransY = 0

Persp0·w·x3 + Persp1·h·x3 + Persp2·x3 - ScaleX·w - SkewX·h - TransX = 0
Persp0·w·y3 + Persp1·h·y3 + Persp2·y3 - SkewY·w - ScaleY·h - TransY = 0

Persp1·h·x4 + Persp2·x4 - SkewX·h - TransX = 0
Persp1·h·y4 + Persp2·y4 - ScaleY·h - TransY = 0
</code></pre></div><p>最后，将具体的坐标值代入，就能将最终值求解出。</p> <p>以下是最终参考计算方法：</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">export</span> <span class="token keyword">type</span> <span class="token class-name">Point</span> <span class="token operator">=</span> <span class="token punctuation">{</span> x<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span> y<span class="token operator">:</span> <span class="token builtin">number</span> <span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">createPerspectiveMatrixFromPoints</span><span class="token punctuation">(</span>
  topLeft<span class="token operator">:</span> Point<span class="token punctuation">,</span>
  topRight<span class="token operator">:</span> Point<span class="token punctuation">,</span>
  botRight<span class="token operator">:</span> Point<span class="token punctuation">,</span>
  botLeft<span class="token operator">:</span> Point<span class="token punctuation">,</span>
  w<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">,</span>
  h<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">,</span>
<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">{</span> x<span class="token operator">:</span> x1<span class="token punctuation">,</span> y<span class="token operator">:</span> y1 <span class="token punctuation">}</span> <span class="token operator">=</span> topLeft
  <span class="token keyword">const</span> <span class="token punctuation">{</span> x<span class="token operator">:</span> x2<span class="token punctuation">,</span> y<span class="token operator">:</span> y2 <span class="token punctuation">}</span> <span class="token operator">=</span> topRight
  <span class="token keyword">const</span> <span class="token punctuation">{</span> x<span class="token operator">:</span> x3<span class="token punctuation">,</span> y<span class="token operator">:</span> y3 <span class="token punctuation">}</span> <span class="token operator">=</span> botRight
  <span class="token keyword">const</span> <span class="token punctuation">{</span> x<span class="token operator">:</span> x4<span class="token punctuation">,</span> y<span class="token operator">:</span> y4 <span class="token punctuation">}</span> <span class="token operator">=</span> botLeft

  <span class="token keyword">const</span> scaleX <span class="token operator">=</span>
    <span class="token punctuation">(</span>y1 <span class="token operator">*</span> x2 <span class="token operator">*</span> x4 <span class="token operator">-</span>
      x1 <span class="token operator">*</span> y2 <span class="token operator">*</span> x4 <span class="token operator">+</span>
      x1 <span class="token operator">*</span> y3 <span class="token operator">*</span> x4 <span class="token operator">-</span>
      x2 <span class="token operator">*</span> y3 <span class="token operator">*</span> x4 <span class="token operator">-</span>
      y1 <span class="token operator">*</span> x2 <span class="token operator">*</span> x3 <span class="token operator">+</span>
      x1 <span class="token operator">*</span> y2 <span class="token operator">*</span> x3 <span class="token operator">-</span>
      x1 <span class="token operator">*</span> y4 <span class="token operator">*</span> x3 <span class="token operator">+</span>
      x2 <span class="token operator">*</span> y4 <span class="token operator">*</span> x3<span class="token punctuation">)</span> <span class="token operator">/</span>
    <span class="token punctuation">(</span>x2 <span class="token operator">*</span> y3 <span class="token operator">*</span> w <span class="token operator">+</span> y2 <span class="token operator">*</span> x4 <span class="token operator">*</span> w <span class="token operator">-</span> y3 <span class="token operator">*</span> x4 <span class="token operator">*</span> w <span class="token operator">-</span> x2 <span class="token operator">*</span> y4 <span class="token operator">*</span> w <span class="token operator">-</span> y2 <span class="token operator">*</span> w <span class="token operator">*</span> x3 <span class="token operator">+</span> y4 <span class="token operator">*</span> w <span class="token operator">*</span> x3<span class="token punctuation">)</span>
  <span class="token keyword">const</span> skewX <span class="token operator">=</span>
    <span class="token punctuation">(</span><span class="token operator">-</span>x1 <span class="token operator">*</span> x2 <span class="token operator">*</span> y3 <span class="token operator">-</span>
      y1 <span class="token operator">*</span> x2 <span class="token operator">*</span> x4 <span class="token operator">+</span>
      x2 <span class="token operator">*</span> y3 <span class="token operator">*</span> x4 <span class="token operator">+</span>
      x1 <span class="token operator">*</span> x2 <span class="token operator">*</span> y4 <span class="token operator">+</span>
      x1 <span class="token operator">*</span> y2 <span class="token operator">*</span> x3 <span class="token operator">+</span>
      y1 <span class="token operator">*</span> x4 <span class="token operator">*</span> x3 <span class="token operator">-</span>
      y2 <span class="token operator">*</span> x4 <span class="token operator">*</span> x3 <span class="token operator">-</span>
      x1 <span class="token operator">*</span> y4 <span class="token operator">*</span> x3<span class="token punctuation">)</span> <span class="token operator">/</span>
    <span class="token punctuation">(</span>x2 <span class="token operator">*</span> y3 <span class="token operator">*</span> h <span class="token operator">+</span> y2 <span class="token operator">*</span> x4 <span class="token operator">*</span> h <span class="token operator">-</span> y3 <span class="token operator">*</span> x4 <span class="token operator">*</span> h <span class="token operator">-</span> x2 <span class="token operator">*</span> y4 <span class="token operator">*</span> h <span class="token operator">-</span> y2 <span class="token operator">*</span> h <span class="token operator">*</span> x3 <span class="token operator">+</span> y4 <span class="token operator">*</span> h <span class="token operator">*</span> x3<span class="token punctuation">)</span>
  <span class="token keyword">const</span> transX <span class="token operator">=</span> x1
  <span class="token keyword">const</span> skewY <span class="token operator">=</span>
    <span class="token punctuation">(</span><span class="token operator">-</span>y1 <span class="token operator">*</span> x2 <span class="token operator">*</span> y3 <span class="token operator">+</span>
      x1 <span class="token operator">*</span> y2 <span class="token operator">*</span> y3 <span class="token operator">+</span>
      y1 <span class="token operator">*</span> y3 <span class="token operator">*</span> x4 <span class="token operator">-</span>
      y2 <span class="token operator">*</span> y3 <span class="token operator">*</span> x4 <span class="token operator">+</span>
      y1 <span class="token operator">*</span> x2 <span class="token operator">*</span> y4 <span class="token operator">-</span>
      x1 <span class="token operator">*</span> y2 <span class="token operator">*</span> y4 <span class="token operator">-</span>
      y1 <span class="token operator">*</span> y4 <span class="token operator">*</span> x3 <span class="token operator">+</span>
      y2 <span class="token operator">*</span> y4 <span class="token operator">*</span> x3<span class="token punctuation">)</span> <span class="token operator">/</span>
    <span class="token punctuation">(</span>x2 <span class="token operator">*</span> y3 <span class="token operator">*</span> w <span class="token operator">+</span> y2 <span class="token operator">*</span> x4 <span class="token operator">*</span> w <span class="token operator">-</span> y3 <span class="token operator">*</span> x4 <span class="token operator">*</span> w <span class="token operator">-</span> x2 <span class="token operator">*</span> y4 <span class="token operator">*</span> w <span class="token operator">-</span> y2 <span class="token operator">*</span> w <span class="token operator">*</span> x3 <span class="token operator">+</span> y4 <span class="token operator">*</span> w <span class="token operator">*</span> x3<span class="token punctuation">)</span>
  <span class="token keyword">const</span> scaleY <span class="token operator">=</span>
    <span class="token punctuation">(</span><span class="token operator">-</span>y1 <span class="token operator">*</span> x2 <span class="token operator">*</span> y3 <span class="token operator">-</span>
      y1 <span class="token operator">*</span> y2 <span class="token operator">*</span> x4 <span class="token operator">+</span>
      y1 <span class="token operator">*</span> y3 <span class="token operator">*</span> x4 <span class="token operator">+</span>
      x1 <span class="token operator">*</span> y2 <span class="token operator">*</span> y4 <span class="token operator">-</span>
      x1 <span class="token operator">*</span> y3 <span class="token operator">*</span> y4 <span class="token operator">+</span>
      x2 <span class="token operator">*</span> y3 <span class="token operator">*</span> y4 <span class="token operator">+</span>
      y1 <span class="token operator">*</span> y2 <span class="token operator">*</span> x3 <span class="token operator">-</span>
      y2 <span class="token operator">*</span> y4 <span class="token operator">*</span> x3<span class="token punctuation">)</span> <span class="token operator">/</span>
    <span class="token punctuation">(</span>x2 <span class="token operator">*</span> y3 <span class="token operator">*</span> h <span class="token operator">+</span> y2 <span class="token operator">*</span> x4 <span class="token operator">*</span> h <span class="token operator">-</span> y3 <span class="token operator">*</span> x4 <span class="token operator">*</span> h <span class="token operator">-</span> x2 <span class="token operator">*</span> y4 <span class="token operator">*</span> h <span class="token operator">-</span> y2 <span class="token operator">*</span> h <span class="token operator">*</span> x3 <span class="token operator">+</span> y4 <span class="token operator">*</span> h <span class="token operator">*</span> x3<span class="token punctuation">)</span>
  <span class="token keyword">const</span> transY <span class="token operator">=</span> y1
  <span class="token keyword">const</span> persp0 <span class="token operator">=</span>
    <span class="token punctuation">(</span>x1 <span class="token operator">*</span> y3 <span class="token operator">-</span> x2 <span class="token operator">*</span> y3 <span class="token operator">+</span> y1 <span class="token operator">*</span> x4 <span class="token operator">-</span> y2 <span class="token operator">*</span> x4 <span class="token operator">-</span> x1 <span class="token operator">*</span> y4 <span class="token operator">+</span> x2 <span class="token operator">*</span> y4 <span class="token operator">-</span> y1 <span class="token operator">*</span> x3 <span class="token operator">+</span> y2 <span class="token operator">*</span> x3<span class="token punctuation">)</span> <span class="token operator">/</span>
    <span class="token punctuation">(</span>x2 <span class="token operator">*</span> y3 <span class="token operator">*</span> w <span class="token operator">+</span> y2 <span class="token operator">*</span> x4 <span class="token operator">*</span> w <span class="token operator">-</span> y3 <span class="token operator">*</span> x4 <span class="token operator">*</span> w <span class="token operator">-</span> x2 <span class="token operator">*</span> y4 <span class="token operator">*</span> w <span class="token operator">-</span> y2 <span class="token operator">*</span> w <span class="token operator">*</span> x3 <span class="token operator">+</span> y4 <span class="token operator">*</span> w <span class="token operator">*</span> x3<span class="token punctuation">)</span>
  <span class="token keyword">const</span> persp1 <span class="token operator">=</span>
    <span class="token punctuation">(</span><span class="token operator">-</span>y1 <span class="token operator">*</span> x2 <span class="token operator">+</span> x1 <span class="token operator">*</span> y2 <span class="token operator">-</span> x1 <span class="token operator">*</span> y3 <span class="token operator">-</span> y2 <span class="token operator">*</span> x4 <span class="token operator">+</span> y3 <span class="token operator">*</span> x4 <span class="token operator">+</span> x2 <span class="token operator">*</span> y4 <span class="token operator">+</span> y1 <span class="token operator">*</span> x3 <span class="token operator">-</span> y4 <span class="token operator">*</span> x3<span class="token punctuation">)</span> <span class="token operator">/</span>
    <span class="token punctuation">(</span>x2 <span class="token operator">*</span> y3 <span class="token operator">*</span> h <span class="token operator">+</span> y2 <span class="token operator">*</span> x4 <span class="token operator">*</span> h <span class="token operator">-</span> y3 <span class="token operator">*</span> x4 <span class="token operator">*</span> h <span class="token operator">-</span> x2 <span class="token operator">*</span> y4 <span class="token operator">*</span> h <span class="token operator">-</span> y2 <span class="token operator">*</span> h <span class="token operator">*</span> x3 <span class="token operator">+</span> y4 <span class="token operator">*</span> h <span class="token operator">*</span> x3<span class="token punctuation">)</span>
  <span class="token keyword">const</span> persp2 <span class="token operator">=</span> <span class="token number">1</span>

  <span class="token keyword">return</span> <span class="token punctuation">[</span>scaleX<span class="token punctuation">,</span> skewX<span class="token punctuation">,</span> transX<span class="token punctuation">,</span> skewY<span class="token punctuation">,</span> scaleY<span class="token punctuation">,</span> transY<span class="token punctuation">,</span> persp0<span class="token punctuation">,</span> persp1<span class="token punctuation">,</span> persp2<span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="_3-绘制举例"><a href="#_3-绘制举例" class="header-anchor">#</a> 3 绘制举例</h2> <p>拿文章开头 2.5D 模型的例子，来绘制一个这样的图形：</p> <p><img src="https://img20.360buyimg.com/ling/s316x0_jfs/t1/52954/33/22747/109474/63c4afa0Feb0bbf71/d9bf8ad24aa62f46.png" alt="bukefenli"></p> <h3 id="_3-1-图层分析"><a href="#_3-1-图层分析" class="header-anchor">#</a> 3.1 图层分析</h3> <p>这个图形主要由上下两部分组成。上部分由一个渐变背景层以及一个方格覆盖层组成，需要进行背景颜色渐变以及方格绘制；下部分由一个渐变背景层以及一个棋盘格覆盖层组成，同样需要背景颜色渐变以及方格绘制，同时图形有透视效果，需要进行透视变换。</p> <p><img src="https://img13.360buyimg.com/ling/s616x0_jfs/t1/212778/15/24457/182673/63c4b041Fd2f90c0e/42bb4eb7070cedff.png" alt="bukefenli"></p> <p>由此，可以将该图形拆解成上下两个部分，因为同样由方格层以及背景层组成，其实可以将之绘制成一个图形，通过输入不同的参数进行变化（透视、方格填色）。</p> <h3 id="_3-2-图形绘制"><a href="#_3-2-图形绘制" class="header-anchor">#</a> 3.2 图形绘制</h3> <p><strong>背景层</strong></p> <ul><li>给整个图形画一个方框，加上渐变着色器即完成背景绘制。</li></ul> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">const</span> backgroundPaint <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Paint</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
backgroundPaint<span class="token punctuation">.</span><span class="token function">setStyle</span><span class="token punctuation">(</span>PaintStyle<span class="token punctuation">.</span>Fill<span class="token punctuation">)</span>

<span class="token keyword">const</span> points <span class="token operator">=</span> <span class="token punctuation">{</span>
  begin<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> height<span class="token punctuation">]</span><span class="token punctuation">,</span>
  end<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> colors <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token function">parseColorString</span><span class="token punctuation">(</span>beginColor<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">parseColorString</span><span class="token punctuation">(</span>endColor<span class="token punctuation">)</span><span class="token punctuation">]</span>
<span class="token keyword">const</span> shader <span class="token operator">=</span> Shader<span class="token punctuation">.</span><span class="token function">MakeLinearGradient</span><span class="token punctuation">(</span>points<span class="token punctuation">.</span>begin<span class="token punctuation">,</span> points<span class="token punctuation">.</span>end<span class="token punctuation">,</span> colors<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> TileMode<span class="token punctuation">.</span>Clamp<span class="token punctuation">)</span> <span class="token comment">// 渐变</span>

backgroundPaint<span class="token punctuation">.</span><span class="token function">setShader</span><span class="token punctuation">(</span>shader<span class="token punctuation">)</span>

<span class="token comment">// 绘制矩形</span>
canvas<span class="token punctuation">.</span><span class="token function">drawRect</span><span class="token punctuation">(</span>Rect<span class="token punctuation">.</span><span class="token function">makeXYWH</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> width<span class="token punctuation">,</span> height<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toArray</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> backgroundPaint<span class="token punctuation">)</span>
</code></pre></div><p>绘制结果：</p> <p><img src="https://img13.360buyimg.com/ling/s516x0_jfs/t1/152230/10/28685/100886/63c4b041F88cf7cff/2d8d3df3bc751f2d.png" alt="bukefenli"></p> <p><strong>方格层</strong></p> <ul><li>根据画布宽高和间距计算出 x 方向和 y 方向上绘制的方格个数 + 1，然后根据奇偶数排列绘制矩形，并使用平移矩阵将整体居中。</li> <li>针对方格层图形进行渐变颜色填充或线条颜色填充绘制。</li></ul> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">const</span> rectsPath <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Path</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> lineNum <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// 循环遍历绘制方格</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> yLineNum <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">%</span> <span class="token number">2</span> <span class="token operator">===</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> j <span class="token operator">%</span> <span class="token number">2</span> <span class="token operator">===</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> rect <span class="token operator">=</span> Rect<span class="token punctuation">.</span><span class="token function">makeXYWH</span><span class="token punctuation">(</span>rectSize <span class="token operator">*</span> i<span class="token punctuation">,</span> rectSize <span class="token operator">*</span> j<span class="token punctuation">,</span> rectSize<span class="token punctuation">,</span> rectSize<span class="token punctuation">)</span>
      rectsPath<span class="token punctuation">.</span><span class="token function">addRect</span><span class="token punctuation">(</span>rect<span class="token punctuation">.</span><span class="token function">toArray</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">%</span> <span class="token number">2</span> <span class="token operator">===</span> <span class="token number">1</span> <span class="token operator">&amp;&amp;</span> j <span class="token operator">%</span> <span class="token number">2</span> <span class="token operator">===</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> rect <span class="token operator">=</span> Rect<span class="token punctuation">.</span><span class="token function">makeXYWH</span><span class="token punctuation">(</span>rectSize <span class="token operator">*</span> i<span class="token punctuation">,</span> rectSize <span class="token operator">*</span> j<span class="token punctuation">,</span> rectSize<span class="token punctuation">,</span> rectSize<span class="token punctuation">)</span>
      rectsPath<span class="token punctuation">.</span><span class="token function">addRect</span><span class="token punctuation">(</span>rect<span class="token punctuation">.</span><span class="token function">toArray</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> overlayShader <span class="token operator">=</span>  Shader<span class="token punctuation">.</span><span class="token function">MakeLinearGradient</span><span class="token punctuation">(</span> <span class="token comment">// 方格层渐变</span>
  points<span class="token punctuation">.</span>begin<span class="token punctuation">,</span>
  points<span class="token punctuation">.</span>end<span class="token punctuation">,</span>
  overlayColors<span class="token punctuation">,</span>
  <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  TileMode<span class="token punctuation">.</span>Clamp<span class="token punctuation">,</span>
<span class="token punctuation">)</span>

<span class="token keyword">const</span> rectsPaint <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Paint</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
rectsPaint<span class="token punctuation">.</span><span class="token function">setAntiAlias</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span>
rectsPaint<span class="token punctuation">.</span><span class="token function">setStyle</span><span class="token punctuation">(</span>PaintStyle<span class="token punctuation">.</span>Stroke<span class="token punctuation">)</span>
rectsPaint<span class="token punctuation">.</span><span class="token function">setShader</span><span class="token punctuation">(</span>overlayShader<span class="token punctuation">)</span>

canvas<span class="token punctuation">.</span><span class="token function">drawPath</span><span class="token punctuation">(</span>rectsPath<span class="token punctuation">,</span> rectsPaint<span class="token punctuation">)</span>
</code></pre></div><p>绘制结果：</p> <p><img src="https://img10.360buyimg.com/ling/s516x0_jfs/t1/100593/22/36175/113039/63c4b041F76c6f598/d9a2ab3e1c036c09.png" alt="bukefenli"></p> <p><strong>棋盘方格</strong></p> <ul><li>棋盘方格只需要将方格层绘制样式设置为填充即可。</li></ul> <div class="language-ts extra-class"><pre class="language-ts"><code>rectsPaint<span class="token punctuation">.</span><span class="token function">setStyle</span><span class="token punctuation">(</span>PaintStyle<span class="token punctuation">.</span>Fill<span class="token punctuation">)</span>

canvas<span class="token punctuation">.</span><span class="token function">drawPath</span><span class="token punctuation">(</span>rectsPath<span class="token punctuation">,</span> rectsPaint<span class="token punctuation">)</span>
</code></pre></div><p>绘制结果：</p> <p><img src="https://img20.360buyimg.com/ling/s516x0_jfs/t1/119003/31/31668/110592/63c4b041F7ebbd4eb/d983471cb48bc9be.png" alt="bukefenli"></p> <p><strong>透视方格</strong></p> <ul><li>将方格层加上透视变换即可实现透视效果。</li></ul> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token comment">// 透视矩阵</span>
<span class="token keyword">const</span> m <span class="token operator">=</span> <span class="token function">getPerspectiveMatrix</span><span class="token punctuation">(</span>width<span class="token punctuation">,</span> height<span class="token punctuation">)</span>
<span class="token comment">// 矩阵变换</span>
rectsPath<span class="token punctuation">.</span><span class="token function">transform</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span>

canvas<span class="token punctuation">.</span><span class="token function">drawPath</span><span class="token punctuation">(</span>rectsPath<span class="token punctuation">,</span> rectsPaint<span class="token punctuation">)</span>
</code></pre></div><p>绘制结果：</p> <p><img src="https://img14.360buyimg.com/ling/s516x0_jfs/t1/158720/29/33656/184345/63c4b041F0e3d2d59/b8fd8fc0b816d463.png" alt="bukefenli"></p> <p><strong>图形组合</strong></p> <ul><li>将方格层图形与透视方格图形组合。</li></ul> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token operator">&lt;</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>PerpectiveRect
    width<span class="token operator">=</span><span class="token punctuation">{</span><span class="token number">512</span><span class="token punctuation">}</span>
    height<span class="token operator">=</span><span class="token punctuation">{</span><span class="token number">450</span><span class="token punctuation">}</span>
    beginColor<span class="token operator">=</span><span class="token punctuation">{</span>c0<span class="token punctuation">}</span>
    endColor<span class="token operator">=</span><span class="token punctuation">{</span>c3<span class="token punctuation">}</span>
    isGradient
  <span class="token operator">/</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>PerpectiveRect
    width<span class="token operator">=</span><span class="token punctuation">{</span><span class="token number">512</span><span class="token punctuation">}</span>
    height<span class="token operator">=</span><span class="token punctuation">{</span><span class="token number">300</span><span class="token punctuation">}</span>
    beginColor<span class="token operator">=</span><span class="token punctuation">{</span>c0<span class="token punctuation">}</span>
    endColor<span class="token operator">=</span><span class="token punctuation">{</span>c3<span class="token punctuation">}</span>
    isGradient      <span class="token comment">// 是否渐变</span>
    isPerspective   <span class="token comment">// 是否透视</span>
    isXRect         <span class="token comment">// 是否棋盘格</span>
  <span class="token operator">/</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span><span class="token operator">&gt;</span>
</code></pre></div><p>绘制结果：</p> <p><img src="https:////img10.360buyimg.com/ling/s516x0_jfs/t1/120419/12/34036/210195/63c4b041Fed057bbf/d0b300713c924b66.png" alt="bukefenli"></p> <h2 id="参考资料"><a href="#参考资料" class="header-anchor">#</a> 参考资料</h2> <p><a href="https://skia.org" target="_blank" rel="noopener noreferrer">skia.org<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><a href="https://learn.microsoft.com/en-us/xamarin/xamarin-forms/user-interface/graphics/skiasharp/" target="_blank" rel="noopener noreferrer">https://learn.microsoft.com/en-us/xamarin/xamarin-forms/user-interface/graphics/skiasharp/<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><a href="https://stackoverflow.com/questions/48416118/perspective-transform-in-skia" target="_blank" rel="noopener noreferrer">https://stackoverflow.com/questions/48416118/perspective-transform-in-skia<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/2023/zongjie.html" class="prev">
        Do not be afraid
      </a></span> <span class="next"><a href="/2022/mf.html">
        基于 MF 的组件化共享工作流 - Qcon 广州演讲整理
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.efdf1017.js" defer></script><script src="/assets/js/2.d444b0a2.js" defer></script><script src="/assets/js/1.7ca1e89d.js" defer></script><script src="/assets/js/61.24ba53e0.js" defer></script>
  </body>
</html>
